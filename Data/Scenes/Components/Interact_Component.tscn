[gd_scene load_steps=2 format=3 uid="uid://bnt60muvh63sj"]

[sub_resource type="GDScript" id="GDScript_fjqi6"]
script/source = "@tool
class_name Interact_Component extends StaticBody2D
signal started(data:Interactive_Data)
signal updated(data:Interactive_Data)
signal finished(canceled:bool, data:Interactive_Data)

#NOTE:THIS might work, just move the state here and leave data as logic and 
#static state.

@export var interactive_data : Interactive_Data:
	set(value):
		if value != null and interactive_data != value:
			interactive_data = value
			interactive_data.finished.connect(on_finished)
			interactive_data.updated.connect(on_update)
		else:
			interactive_data = value

#func _ready():
	#if interactive_data != null and !interactive_data.finished.is_connected(on_finished):
	#	interactive_data.finished.connect(on_finished)
#	pass

func on_update(data):
	updated.emit(data)
func on_finished(canceled:bool,data):
	finished.emit(canceled, data)
	
#NOTE: interactee will be self. interact data can have an override or use
#interactee.owner if it wants more data
func on_interact(handler, interactor, interactee = self, data = {}):
	if interactive_data != null:
		interactive_data.interact(handler, interactor, interactee, data)
		started.emit(interactive_data)
"

[node name="Interact_Component" type="StaticBody2D"]
collision_layer = 2
collision_mask = 0
script = SubResource("GDScript_fjqi6")
